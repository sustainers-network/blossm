domain: identity
service: core

public: false

actions:
  - register

schema:
  phone: String
  email: String
  id: String
  normalizedId: String
  principal:
    root: String
    service: String
    network: String

indexes:
  - normalizedId
  - principal.root
  - principal.service
  - principal.network

testing:
  examples:
    - action: register
      payload:
        phone: "+19195551155"
        principal:
          root: some-principal
          service: some-principal-service
          network: some.principal-network
        email: some-email
        id: Some-Id
        normalizedId: some-id
    - action: register
      payload:
        phone: "+19195551133"
        principal:
          root: some-other-principal
          service: some-other-principal-service
          network: some.other-principal-network
        email: some-other-email
        id: Some-other-Id
        normalizedId: some-other-id

  handlers:
    - action: register
      examples:
        - state:
            id: some-id
            phone: "+19195551133"
            principal:
              root: some-principal-root
              service: some-principal-service
              network: some.principal-network
          payload:
            id: Some-Other-id
            normalizedId: some-other-id
            phone: "+19195551144"
            principal:
              root: some-other-principal-root
              service: some-other-principal-service
              network: some.other-principal-network
          result:
            id: Some-Other-id
            normalizedId: some-other-id
            phone: "+19195551144"
            principal:
              root: some-other-principal-root
              service: some-other-principal-service
              network: some.other-principal-network

#don't change
procedure: event-store
