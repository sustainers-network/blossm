name: state
domain: key
service: system

dependencies:
  "@blossm/event-store-rpc": "*"
  "@blossm/gcp-token": "*"

devDependencies:
  "mocha": "^7.1.0"
  "chai": "^4.2.0"
  "sinon": "^7.3.2"
  "sinon-chai": "^3.3.0"
  "@blossm/request": "*"

testing:
  dependencies:
    - procedure: event-store
      domain: key
      service: system

  steps:
    - pre:
        - domain: key
          service: system
          root: some-key-root
          action: create
          payload:
            principal:
              root: some-principal-root
              service: some-principal-service
              network: some-principal-network
            secret: some-secret
            node:
              root: some-node-root
              service: some-node-service
              network: some-node-network
            network: some-network
      root: some-key-root
      response:
        root: some-key-root
        principal:
          root: some-principal-root
          service: some-principal-service
          network: some-principal-network
        secret: some-secret
        node:
          root: some-node-root
          service: some-node-service
          network: some-node-network
        network: some-network
    - root: some-other-root
      code: 404

#don't change
procedure: fact
